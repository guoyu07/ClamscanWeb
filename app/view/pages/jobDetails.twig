{% extends "/layouts/" ~ layout ~ ".twig" %}

{% block pageTitle %}ClamAV Web - Job Details{% endblock %}

{% block content %}
    <h2>ClamAV Job Details</h2>
    
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Job Information</h3>
        </div>
        <div class="panel-body">
            <dl class="dl-horizontal">
                <dt>State</dt>
                <dd>{{ job.state|capitalize }}</dd>
                <dt>Added By</dt>
                <dd>{{ job.addedBy }}</dd>
                <dt>Added At</dt>
                <dd>{{ job.addedAt|date }}</dd>
                <dt>Report Address</dt>
                <dd>{{ job.reportAddress }}</dd>
                <dt>User To Scan</dt>
                <dd>{{ job.username }}</dd>
                <dt>Exclude Directories</dt>
                <dd>{{ job.excludeDirs|join(",") }}</dd>
                <dt>Exclude Files</dt>
                <dd>{{ job.excludeFiles|join(",") }}</dd>
            </dl>
        </div>
    </div>
    
    {% if job.result is not null %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Scan Results</h3>
            </div>
            <div class="panel-body">
                <dl class="dl-horizontal">
                    <dt>Completed</dt>
                    <dd>{{ job.result.completedAt|date }}</dd>
                    <dt>Scanned Directories</dt>
                    <dd>{{ job.result.scannedDirectories }}</dd>
                    <dt>Scanned Files</dt>
                    <dd>{{ job.result.scannedFiles }}</dd>
                    <dt>Infected Files</dt>
                    <dd>{{ job.result.infectedFiles }}</dd>
                    <dt>Data Scanned</dt>
                    <dd>{{ job.result.dataScanned }}</dd>
                    <dt>Data Read</dt>
                    <dd>{{ job.result.dataRead }}</dd>
                    <dt>Execution Time</dt>
                    <dd>{{ job.result.executionTime }}</dd>
                </dl>
                
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>Result</th>
                            <th>File</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for result in job.result.fileResults %}
                            <tr class="
                                {% if result.status != "FOUND"  %}
                                    success
                                {% else %}
                                    danger
                                {% endif %}
                            ">
                                <td>{{ result.status }}</td>
                                <td>{{ result.file }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                
            </div>
        </div>
    {% endif %}
{% endblock %}